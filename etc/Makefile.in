include ../def.mk

SHELL=/bin/sh

SOURCE_DIRS=init.d

INSTALL_FILES=.profile_msgpp \
               msgpp_config.py \
	       products.py

all:
	@for i in $(SOURCE_DIRS) ; \
	do \
		echo "--------Compiling directory $$i----------"; \
		TDIR=`pwd` ; \
		cd $$i; \
		$(MAKE); \
		cd $$TDIR; \
	done;

clean:
	@\rm -f core *.pyc *~
	@for i in $(SOURCE_DIRS) ; \
	do \
		echo "--------Cleaning directory $$i----------"; \
		TDIR=`pwd`; \
		cd $$i; \
		$(MAKE) clean; \
		cd $$TDIR; \
	done;

distclean:
	@\rm -f core *.pyc *~
	@\rm -f Makefile
	@\rm -f .profile_msgpp msgpp_config.py
	@for i in $(SOURCE_DIRS) ; \
	do \
		echo "-----Distcleaning directory $$i-------"; \
		TDIR=`pwd`; \
		cd $$i; \
		$(MAKE) distclean; \
		cd $$TDIR; \
	done

install:
	@for i in $(INSTALL_FILES) ; \
	do \
		$(HLHDF_INSTALL_BIN) -f -o -m644 -C $$i @prefix@/etc/$$i; \
	done
	@for i in $(SOURCE_DIRS) ; \
	do \
		echo "--------Installing from directory $$i-------"; \
		TDIR=`pwd`; \
		cd $$i; \
		$(MAKE) install; \
		cd $$TDIR; \
	done

uninstall:
	@for i in $(INSTALL_FILES) ; \
	do \
		rm -f @prefix@/etc/$$i; \
	done
	@for i in $(SOURCE_DIRS) ; \
	do \
		echo "--------Uninstalling from directory $$i-------"; \
		TDIR=`pwd`; \
		cd $$i; \
		$(MAKE) uninstall; \
		cd $$TDIR; \
	done